"use strict";(self.webpackChunkvristo_angular=self.webpackChunkvristo_angular||[]).push([[516],{8516:(jt,O,l)=>{l.r(O),l.d(O,{POSMainPageModule:()=>Qt});var c=l(6895),m=l(3559),_=l(5861),u=l(7340),t=l(4650),P=l(4609),y=l(798),v=l(2477),I=l(133),k=l(2924),q=l(1258),g=l(4180),N=l(3210),J=l(7351),K=l(3222),H=l(2808),U=l(9872),d=l(4006),h=l(3538),f=l(4463);const G=["PosShiftDetails"],F=["PosShiftClose"],D=["PosShiftOpen"];function Q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.openShift())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"OpenShift")))}function V(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.closeShift())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CloseShift")))}function j(i,a){if(1&i&&(t.ynx(0),t.YNc(1,Q,3,3,"button",7),t.YNc(2,V,3,3,"button",8),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.currentShiftId),t.xp6(1),t.Q6J("ngIf",e.currentShiftId)}}function B(i,a){1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"NewShift")))}const b=function(i){return{"is-invalid":i}};function Y(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13)(2,"div",14)(3,"p",15),t._uU(4),t.ALo(5,"translate"),t.TgZ(6,"span",16),t._uU(7),t.qZA()()(),t.TgZ(8,"div")(9,"div")(10,"label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"input",17),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.model.startCash=n)}),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.hij("",t.lcZ(5,5,"StoreName"),": "),t.xp6(3),t.Oqu(e.model.branchName),t.xp6(4),t.Oqu(t.lcZ(12,7,"CashStart")),t.xp6(2),t.Q6J("ngModel",e.model.startCash)("ngClass",t.VKq(9,b,e.inputFailds.startCash))}}function E(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19)(2,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closeModel())}),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.CreateShiftSave())}),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,2,"Discard")),t.xp6(3),t.Oqu(t.lcZ(7,4,"OpenNow")))}function W(i,a){1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CloseShift")))}function $(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13)(2,"div",22)(3,"p",15),t._uU(4),t.ALo(5,"translate"),t.TgZ(6,"span",16),t._uU(7),t.qZA()(),t.TgZ(8,"p",15),t._uU(9),t.ALo(10,"translate"),t.TgZ(11,"span",16),t._uU(12),t.ALo(13,"number"),t.qZA()()(),t.TgZ(14,"div",22)(15,"p",15),t._uU(16),t.ALo(17,"translate"),t.TgZ(18,"span",23),t._uU(19),t.qZA()(),t._uU(20,", "),t.TgZ(21,"p",15),t._uU(22),t.ALo(23,"translate"),t.TgZ(24,"span",23),t._uU(25),t.ALo(26,"date"),t.qZA()()(),t.TgZ(27,"div")(28,"div")(29,"label"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"input",17),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.model.endCash=n)}),t.qZA()(),t.TgZ(33,"div")(34,"label"),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"input",24),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.model.closingNotes=n)}),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.hij("",t.lcZ(5,14,"StoreName"),": "),t.xp6(3),t.Oqu(e.shiftDetails.branchName),t.xp6(2),t.hij("",t.lcZ(10,16,"StartCash"),": "),t.xp6(3),t.Oqu(t.lcZ(13,18,e.shiftDetails.startCash)),t.xp6(4),t.hij("",t.lcZ(17,20,"CreatedBy"),": "),t.xp6(3),t.Oqu(e.shiftDetails.createByName),t.xp6(3),t.hij("",t.lcZ(23,22,"CreatedAt"),": "),t.xp6(3),t.Oqu(t.xi3(26,24,e.shiftDetails.startTime,"dd/MM/yyyy \u2022 h:mm a")),t.xp6(5),t.Oqu(t.lcZ(31,27,"EndCash")),t.xp6(2),t.Q6J("ngModel",e.model.endCash)("ngClass",t.VKq(31,b,e.inputFailds.startCash)),t.xp6(3),t.Oqu(t.lcZ(36,29,"ClosingNotes")),t.xp6(2),t.Q6J("ngModel",e.model.closingNotes)("ngClass",t.VKq(33,b,e.inputFailds.startCash))}}function R(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19)(2,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closeModel())}),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.CloseShiftSave())}),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,2,"Discard")),t.xp6(3),t.Oqu(t.lcZ(7,4,"CloseNow")))}let M=(()=>{class i{constructor(e,o,n,s){this.gto=e,this.shiftManagement=o,this.accountingService=n,this.common=s,this.options={},this.model={},this.ShowButtons=!0,this.lstLkpKeys=[],this.lstLkps={},this.reqFields=[],this.inputFailds={},this.shiftDetails={},this.lstWords={PleaseCloseAllOpenedOrdersFirst:""},this.common.loadLkps(this.lstLkpKeys,this.lstLkps),this.shiftManagement.CheckDeviceKey(),this.common.translateList(this.lstWords),this.currentShiftId||this.shiftManagement.CheckCurrentShift({OnFinish:this.handleShiftStatus.bind(this)})}initialShiftData(){}handleShiftStatus(){this.currentShiftId=this.shiftManagement.CurrentShiftId}openModel(e){e?.open()}save(){this.openPosShiftDetails.close()}closeModel(){this.openPosShiftClose?.close(),this.openPosShiftOpen?.close(),this.openPosShiftDetails?.close()}openShift(){this.openModel(this.openPosShiftOpen)}prepareObjToServer_CS(e){var o=this;return(0,_.Z)(function*(){let n=e;return n.DeviceKey=yield o.shiftManagement.CheckDeviceKey(),n})()}CreateShiftSave(){var e=this;return(0,_.Z)(function*(){e.reqFields=["startCash"],e.inputFailds={};let o=e.common.checkValidation(e.model,e.reqFields);if(o.isValid){let n=yield e.prepareObjToServer_CS(e.model);e.accountingService.AddShift({OpenShift:n}).subscribe({next:s=>{e.inputFailds={},s.status&&(e.common.success("\u062a\u0645 \u0627\u0644\u062d\u0641\u0638"),e.currentShiftId=s.entityId,e.shiftManagement.SetCurrentShiftId(e.currentShiftId),e.openPosShiftOpen.close(),e.model={}),s.lstError.length>0&&e.common.error("Error",s.lstError[0])},error:s=>{e.common.error("Fill required fields","")}})}else e.inputFailds=o.failerFields,e.common.error("Fill required fields","")})()}closeShift(){this.accountingService.ShiftDetails({shiftId:this.currentShiftId}).subscribe(e=>{this.shiftDetails=e}),this.openModel(this.openPosShiftClose)}prepareObjToServer_ClS(e){return{...e,DeviceKey:this.shiftManagement.DeviceKey}}CloseShiftSave(){this.reqFields=["endCash"],this.inputFailds={};let e=this.common.checkValidation(this.model,this.reqFields);if(e.isValid){let o=this.prepareObjToServer_ClS(this.model);this.accountingService.AddShift({CloseShift:o}).subscribe({next:n=>{if(this.inputFailds={},n.status&&(this.common.success("\u062a\u0645 \u0627\u0644\u0627\u063a\u0644\u0627\u0642"),this.shiftManagement.ClearCurrentShiftId(),this.openPosShiftClose?.close(),this.currentShiftId=0),n.lstError.length>0){let s=n.lstError[0];s.indexOf("anyOpenedOrder")>-1?this.common.error(this.lstWords.PleaseCloseAllOpenedOrdersFirst+"=>"+s.split("_")[1]):this.common.error(n.lstError[0])}},error:n=>{this.common.error("Fill required fields","")}})}else this.inputFailds=e.failerFields,this.common.error("Fill required fields","")}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(P.L),t.Y36(I.p),t.Y36(U.S),t.Y36(v.j))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-crud-shift"]],viewQuery:function(o,n){if(1&o&&(t.Gf(G,7),t.Gf(F,7),t.Gf(D,7)),2&o){let s;t.iGM(s=t.CRH())&&(n.openPosShiftDetails=s.first),t.iGM(s=t.CRH())&&(n.openPosShiftClose=s.first),t.iGM(s=t.CRH())&&(n.openPosShiftOpen=s.first)}},inputs:{ShowButtons:"ShowButtons"},decls:17,vars:1,consts:[[4,"ngIf"],[1,"modal-top","rounded","lg"],["PosShiftOpen",""],["modalHeader",""],["modalBody",""],["modalFooter",""],["PosShiftClose",""],["type","button","class","w-full btn btn-primary",3,"click",4,"ngIf"],["type","button","class","w-full btn btn-danger",3,"click",4,"ngIf"],["type","button",1,"w-full","btn","btn-primary",3,"click"],["type","button",1,"w-full","btn","btn-danger",3,"click"],[1,"!py-2","title"],[1,"grid","grid-cols-8","pb-4"],[1,"col-span-8"],[1,"flex"],[1,"font-bold"],[1,"text-primary"],["type","number",1,"form-input",3,"ngModel","ngClass","ngModelChange"],[1,"flex","justify-end","w-full"],[1,"flex","justify-end"],["type","button",1,"btn-outline-danger","btn",3,"click"],["type","button",1,"rtl:mr-4","ltr:ml-4","btn","btn-success",3,"click"],[1,"flex","space-x-3"],[1,""],["type","text",1,"form-input",3,"ngModel","ngClass","ngModelChange"]],template:function(o,n){1&o&&(t.YNc(0,j,3,2,"ng-container",0),t.TgZ(1,"modal",1,2),t.YNc(3,B,3,3,"ng-template",null,3,t.W1O),t.YNc(5,Y,14,11,"ng-template",null,4,t.W1O),t.YNc(7,E,8,6,"ng-template",null,5,t.W1O),t.qZA(),t.TgZ(9,"modal",1,6),t.YNc(11,W,3,3,"ng-template",null,3,t.W1O),t.YNc(13,$,38,35,"ng-template",null,4,t.W1O),t.YNc(15,R,8,6,"ng-template",null,5,t.W1O),t.qZA()),2&o&&t.Q6J("ngIf",n.ShowButtons)},dependencies:[c.mk,c.O5,d.Fj,d.wV,d.JJ,d.On,h.z,c.JJ,c.uU,f.X$]})}return i})();var X=l(454),z=l(8890),Z=l(1835);const tt=["PosStyleSetup"];function et(i,a){1&i&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"POSSetup")))}const nt=function(i){return{"bg-primary text-white":i}};function ot(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"li")(1,"a",15),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.selectTab(s))}),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const e=a.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(4,nt,o.selectedTab.value===e.value)),t.xp6(1),t.Oqu(t.lcZ(3,2,e.label))}}function it(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div")(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"input",10),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.model.GeneralZoomOut=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.styleChanged())}),t.qZA()()(),t.TgZ(6,"div",11)(7,"ul",12),t.YNc(8,ot,4,6,"li",13),t.qZA()(),t.GkF(9,14)(10,14)(11,14)}if(2&i){const e=t.oxw(),o=t.MAs(9),n=t.MAs(11),s=t.MAs(13);t.xp6(3),t.Oqu(t.lcZ(4,6,"Layout")),t.xp6(2),t.Q6J("ngModel",e.model.GeneralZoomOut),t.xp6(3),t.Q6J("ngForOf",e.tabs),t.xp6(1),t.Q6J("ngTemplateOutlet",o),t.xp6(1),t.Q6J("ngTemplateOutlet",n),t.xp6(1),t.Q6J("ngTemplateOutlet",s)}}function st(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",16),t._UZ(1,"div"),t.TgZ(2,"div",17)(3,"button",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.close())}),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save())}),t._uU(7),t.ALo(8,"translate"),t.qZA()()()}2&i&&(t.xp6(4),t.Oqu(t.lcZ(5,2,"Discard")),t.xp6(3),t.Oqu(t.lcZ(8,4,"Save")))}function at(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",21)(1,"div")(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ng-select",22),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.layout=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(6,"div")(7,"label"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.cols=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(11,"div")(12,"label"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.boxHeight=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(16,"div")(17,"label",24)(18,"input",25),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.withImage=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA(),t.TgZ(19,"span"),t._uU(20),t.ALo(21,"translate"),t.qZA()()(),t.TgZ(22,"div")(23,"label"),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.width=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(27,"div")(28,"label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t.TgZ(31,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.category.height=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,14,"Layout")),t.xp6(2),t.Q6J("items",e.lstCatLayout)("ngModel",e.model.category.layout)("clearable",!1),t.xp6(3),t.Oqu(t.lcZ(9,16,"Cols")),t.xp6(2),t.Q6J("ngModel",e.model.category.cols),t.xp6(3),t.Oqu(t.lcZ(14,18,"BoxHeight")),t.xp6(2),t.Q6J("ngModel",e.model.category.boxHeight),t.xp6(3),t.Q6J("ngModel",e.model.category.withImage),t.xp6(2),t.Oqu(t.lcZ(21,20,"WithImage")),t.xp6(4),t.Oqu(t.lcZ(25,22,"Width")),t.xp6(2),t.Q6J("ngModel",e.model.category.width),t.xp6(3),t.Oqu(t.lcZ(30,24,"Height")),t.xp6(2),t.Q6J("ngModel",e.model.category.height)}}function lt(i,a){if(1&i&&t.YNc(0,at,32,26,"div",20),2&i){const e=t.oxw();t.Q6J("ngIf",0==e.selectedTab.value)}}function rt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",21)(1,"div")(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ng-select",22),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.style=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(6,"div")(7,"label"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.cols=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(11,"div")(12,"label"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.boxHeight=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(16,"div")(17,"label",24)(18,"input",25),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.withImage=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA(),t.TgZ(19,"span"),t._uU(20),t.ALo(21,"translate"),t.qZA()()(),t.TgZ(22,"div")(23,"label"),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.width=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()(),t.TgZ(27,"div")(28,"label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t.TgZ(31,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.Items.height=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,14,"Layout")),t.xp6(2),t.Q6J("items",e.lstItmLayout)("ngModel",e.model.Items.style)("clearable",!1),t.xp6(3),t.Oqu(t.lcZ(9,16,"Cols")),t.xp6(2),t.Q6J("ngModel",e.model.Items.cols),t.xp6(3),t.Oqu(t.lcZ(14,18,"BoxHeight")),t.xp6(2),t.Q6J("ngModel",e.model.Items.boxHeight),t.xp6(3),t.Q6J("ngModel",e.model.Items.withImage),t.xp6(2),t.Oqu(t.lcZ(21,20,"WithImage")),t.xp6(4),t.Oqu(t.lcZ(25,22,"Width")),t.xp6(2),t.Q6J("ngModel",e.model.Items.width),t.xp6(3),t.Oqu(t.lcZ(30,24,"Height")),t.xp6(2),t.Q6J("ngModel",e.model.Items.height)}}function ct(i,a){if(1&i&&t.YNc(0,rt,32,26,"div",20),2&i){const e=t.oxw();t.Q6J("ngIf",1==e.selectedTab.value)}}function dt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",21)(1,"div")(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"input",23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.model.cart.cols=n)})("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.styleChanged())}),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,2,"itemsBoxHeight")),t.xp6(2),t.Q6J("ngModel",e.model.cart.cols)}}function mt(i,a){if(1&i&&t.YNc(0,dt,6,4,"div",20),2&i){const e=t.oxw();t.Q6J("ngIf",2==e.selectedTab.value)}}let A=(()=>{class i{readStyleSetup(){var e=this;return(0,_.Z)(function*(){let o=yield e.storeManagementService.getItem("StyleSetup");e.model=o||e.gto.DefaultStyle,e.openModel(),e.selectTab(e.tabs[0])})()}constructor(e,o,n,s){this.common=e,this.storeManagementService=o,this.gto=n,this.invoiceHelperService=s,this.model={},this.tabs=[{label:"CategoriesPart",value:0},{label:"CategoryItems",value:1},{label:"Cart",value:2}],this.selectedTab={},this.lstCatLayout=[{label:"VER",value:"V"},{label:"HOR",value:"H"},{label:"LV",value:"LV"}],this.lstItmLayout=[{label:"Style1",value:"0"},{label:"Style2",value:"1"}],this.openPosStyleSetup=n.openPosStyleSetup$.subscribe(r=>{this.readStyleSetup()})}ngOnDestroy(){this.openPosStyleSetup&&this.openPosStyleSetup.unsubscribe()}openModel(){this.PosStyleSetup?.open()}close(){this.PosStyleSetup?.close()}save(){this.PosStyleSetup?.close(),this.storeManagementService.setItem("StyleSetup",this.model)}selectTab(e){this.selectedTab=e}styleChanged(){setTimeout(()=>{this.gto.applyLayoutClasses(this.model)},10)}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(v.j),t.Y36(z.T),t.Y36(P.L),t.Y36(y.w))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-pos-page-layout"]],viewQuery:function(o,n){if(1&o&&t.Gf(tt,7),2&o){let s;t.iGM(s=t.CRH())&&(n.PosStyleSetup=s.first)}},decls:14,vars:0,consts:[[1,"modal-top","rounded","extra-large-modal","lg","no-select"],["PosStyleSetup",""],["modalHeader",""],["modalBody",""],["modalFooter",""],["Cat",""],["Items",""],["Cart",""],[1,"!py-2","title"],[1,"gap-2","grid","grid-cols-4"],["type","number","step","0.01",1,"form-input",3,"ngModel","ngModelChange","change"],[1,"mb-2"],[1,"flex","flex-wrap"],[4,"ngFor","ngForOf"],[3,"ngTemplateOutlet"],["href","javascript:",1,"block","hover:bg-primary","ltr:mr-2","-mb-[1px]","rtl:ml-2","p-3.5","py-2","rounded","hover:text-white",3,"ngClass","click"],[1,"flex","justify-between","w-full"],[1,"flex","justify-end"],["type","button",1,"btn-outline-danger","btn",3,"click"],["type","button",1,"rtl:mr-4","ltr:ml-4","btn","btn-success",3,"click"],["class","gap-3 grid grid-cols-4",4,"ngIf"],[1,"gap-3","grid","grid-cols-4"],["bindLabel","label","bindValue","value",1,"form-control",3,"items","ngModel","clearable","ngModelChange","change"],["type","number",1,"form-input",3,"ngModel","ngModelChange","change"],[1,"inline-flex"],["type","checkbox",1,"form-checkbox",3,"ngModel","ngModelChange","change"]],template:function(o,n){1&o&&(t.TgZ(0,"modal",0,1),t.YNc(2,et,3,3,"ng-template",null,2,t.W1O),t.YNc(4,it,12,8,"ng-template",null,3,t.W1O),t.YNc(6,st,9,6,"ng-template",null,4,t.W1O),t.qZA(),t.YNc(8,lt,1,1,"ng-template",null,5,t.W1O),t.YNc(10,ct,1,1,"ng-template",null,6,t.W1O),t.YNc(12,mt,1,1,"ng-template",null,7,t.W1O))},dependencies:[c.mk,c.sg,c.O5,c.tP,d.Fj,d.wV,d.Wl,d.JJ,d.On,h.z,Z.w9,f.X$],styles:[".cartView[_ngcontent-%COMP%]{background-color:#fff;.itemsList {overflow-y: auto;}}.CartTotalsView0[_ngcontent-%COMP%]{input {height: 28px; padding: 2px;} input:disabled {background: #efefef;}}.CartTotalsView1[_ngcontent-%COMP%]{.tb2 {width: 100%} .tb2 {display: flex;} .tb2 {width: 100%;} .tb2_1 {width: 150px} .tb2_1 {display: flex;} .tb2 .p1 {min-width: 130px; font-size: 13px} .tb2 .p1 {font-weight: 700;} .tb2 .s1 {font-weight: 700;} .tb2 .s1 { --tw-text-opacity: 1; color: rgb(67 97 238 / var(--tw-text-opacity)); } .tb2 .s2 {padding-right: .5rem;} .tb2 .s2 {font-weight: 700;} .tb2 .s2 { --tw-text-opacity: 1; color: rgb(128 93 202 / var(--tw-text-opacity)); } .icsd {max-height: 57vh; min-height: 57vh; overflow: auto;}}"]})}return i})();function ut(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.selectCategory(s))}),t.TgZ(1,"div",16),t._UZ(2,"div",17),t.TgZ(3,"div",18)(4,"p",19),t._uU(5),t.qZA(),t.TgZ(6,"p",20),t._uU(7),t.ALo(8,"translate"),t.qZA()()()()}if(2&i){const e=a.$implicit,o=t.oxw(2);t.Gre("itm cartb ",o.selectedCategory.value==e.value?"selected":""," "),t.uIk("data-id",e.value),t.xp6(2),t.Udp("background-image","url("+(e.str1?e.str1:o.defaultCategoryImage)+")"),t.xp6(3),t.Oqu(e.label),t.xp6(2),t.AsE("",12," ",t.lcZ(8,9,"Item"),"")}}function pt(i,a){if(1&i&&(t.TgZ(0,"div",12)(1,"div",13),t.YNc(2,ut,9,11,"div",14),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.lstLkps.ItemGroups)}}function gt(i,a){}const C=function(i){return{cat:i}};function _t(i,a){if(1&i&&(t.ynx(0),t.GkF(1,3),t.BQk()),2&i){const e=t.oxw(2).cat;t.oxw();const o=t.MAs(15);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,C,e))}}function ht(i,a){if(1&i&&(t.ynx(0),t.GkF(1,3),t.BQk()),2&i){const e=t.oxw(2).cat;t.oxw();const o=t.MAs(17);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,C,e))}}function ft(i,a){if(1&i&&(t.TgZ(0,"div",22)(1,"p",23),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,_t,2,4,"ng-container",24),t.YNc(5,ht,2,4,"ng-container",24),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",e.selectedCategory.label," ",t.lcZ(3,4,"Menu"),""),t.xp6(2),t.Q6J("ngIf",0==e.currentLayout.Items.style),t.xp6(1),t.Q6J("ngIf",1==e.currentLayout.Items.style)}}function Ct(i,a){if(1&i&&t.YNc(0,ft,6,6,"div",21),2&i){const e=t.oxw();t.Q6J("ngIf",e.currentLayout&&e.currentLayout.Items)}}const w=function(i){return{item:i}};function xt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.selectItem(s))}),t.TgZ(1,"div",30),t._UZ(2,"div",17),t.TgZ(3,"div",31)(4,"p",19),t._uU(5),t.qZA(),t.TgZ(6,"p",32),t._uU(7),t.qZA()()(),t.TgZ(8,"div",33)(9,"div",34),t._uU(10),t.TgZ(11,"span",35),t._uU(12),t.qZA()(),t.GkF(13,3),t.qZA()()}if(2&i){const e=a.$implicit,o=t.oxw(3),n=t.MAs(11);let s;t.uIk("data-id",e.id),t.xp6(2),t.Udp("background-image","url("+e.img+")"),t.xp6(3),t.Oqu(null!==(s=e.name)&&void 0!==s?s:"en"==o.common.currLang?e.nameEn:e.nameAr),t.xp6(2),t.hij("",e.description," "),t.xp6(3),t.hij("$",e.price," "),t.xp6(2),t.Oqu(e.unitName),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(9,w,e))}}function Pt(i,a){if(1&i&&(t.TgZ(0,"div",26)(1,"div",27),t.YNc(2,xt,14,11,"div",28),t.qZA()()),2&i){const e=t.oxw().cat;t.xp6(2),t.Q6J("ngForOf",e.lstItems)}}function yt(i,a){1&i&&t.YNc(0,Pt,3,1,"div",25),2&i&&t.Q6J("ngIf",a.cat)}function vt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.selectItem(s))}),t._UZ(1,"div",17),t.TgZ(2,"div",30)(3,"div",31)(4,"p",19),t._uU(5),t.qZA()()(),t.TgZ(6,"div",33)(7,"div",34),t._uU(8),t.TgZ(9,"span",35),t._uU(10),t.qZA()(),t.GkF(11,3),t.qZA()()}if(2&i){const e=a.$implicit,o=t.oxw(3),n=t.MAs(11);let s;t.uIk("data-id",e.id),t.xp6(1),t.Udp("background-image","url("+e.img+")"),t.xp6(4),t.Oqu(null!==(s=e.name)&&void 0!==s?s:"en"==o.common.currLang?e.nameEn:e.nameAr),t.xp6(3),t.hij("$",e.price," "),t.xp6(2),t.Oqu(e.unitName),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(8,w,e))}}function bt(i,a){if(1&i&&(t.TgZ(0,"div",37)(1,"div",38),t.YNc(2,vt,12,10,"div",28),t.qZA()()),2&i){const e=t.oxw().cat;t.xp6(2),t.Q6J("ngForOf",e.lstItems)}}function Tt(i,a){1&i&&t.YNc(0,bt,3,1,"div",36),2&i&&t.Q6J("ngIf",a.cat)}function St(i,a){if(1&i&&t._UZ(0,"app-cart-items",39),2&i){const e=t.oxw();t.Q6J("orderDetails",e.model)("cartChangeItemQty",e.cartChangeItemQty)("calculateInvoiceTotals",e.invoiceHelperService.calculateInvoiceTotals)}}function Ot(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"a",54),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.openPosSetup())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Setup")))}function It(i,a){1&i&&(t.TgZ(0,"ul",52)(1,"li"),t.YNc(2,Ot,3,3,"a",53),t.qZA()()),2&i&&t.Q6J("@toggleAnimation",void 0)}function Mt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",40)(1,"div",41)(2,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.QuickAutoPay())}),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",43),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.logout())}),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openSplitInvoice())}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",45),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.toTables())}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.printTicket())}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",46)(18,"button",47),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.YNc(21,It,3,1,"ul",48),t.qZA(),t._UZ(22,"app-crud-shift",49),t.TgZ(23,"button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showOrdersList())}),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.PendingBtn())}),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"button",51),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.PaymentBtn())}),t._uU(30),t.ALo(31,"translate"),t.qZA()()()}2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,10,"QuickPay"),""),t.xp6(3),t.Oqu(t.lcZ(7,12,"Logout")),t.xp6(3),t.Oqu(t.lcZ(10,14,"Split")),t.xp6(3),t.Oqu(t.lcZ(13,16,"Tables")),t.xp6(3),t.Oqu(t.lcZ(16,18,"PrintTicket")),t.xp6(4),t.hij(" ",t.lcZ(20,20,"Other")," "),t.xp6(3),t.Q6J("ShowButtons",!0),t.xp6(2),t.Oqu(t.lcZ(25,22,"PendingList")),t.xp6(3),t.Oqu(t.lcZ(28,24,"Pending")),t.xp6(3),t.Oqu(t.lcZ(31,26,"Pay")))}const Zt=[{path:"",component:(()=>{class i{constructor(e,o,n,s,r,p,S){this.gto=e,this.invoiceHelperService=o,this.router=n,this.common=s,this.shiftStateManagement=r,this.managementService=p,this.route=S,this.lstLkpKeys=["ItemGroups"],this.lstLkps={},this.model={},this.currentLayout={},this.selectedCategory={},this.defaultCategoryImage="https://t3.ftcdn.net/jpg/00/78/87/94/360_F_78879462_KyMC4iWhDHLlEEZDAOLiDWPuubnAaMMk.jpg",this.Layout={category:{boxHeight:"",layout:"H",cols:4,withImage:!0,width:0,height:0},cart:{itemsBoxHeight:"64",itemsBoxHeightU:"vh"},Items:{withImage:!0,style:1,height:"full",width:"full",boxHeight:480,cols:4}},this.cartChangeItemQty=(x,Vt)=>{x.quantity=Vt,this.itemsListChanged()},this.cartChangeDiscountService=()=>{this.invoiceHelperService.calculateInvoiceTotals(this.model)},this.payInProgress=!1,this.lstWords={NotValidOrder:""},this.generalPendingOrderCallbacks={onPost:x=>{this.resetCurrentInvoice()},success:x=>{this.common.success("\u062a\u0645 \u0627\u0644\u062d\u0641\u0638")},error:x=>this.common.error("Empty","")},this.routeTableId=this.route.snapshot.queryParamMap.get("tId"),this.routeTblName=this.route.snapshot.queryParamMap.get("t"),this.routeTableId&&this.getInvoiceDetails({tableId:this.routeTableId},{onFinish:()=>this.clearCurrentRoutesParams()}),this.routeInvoiceId=this.route.snapshot.queryParamMap.get("oId"),this.routeInvoiceId&&this.getInvoiceDetails({id:this.routeInvoiceId},{onFinish:()=>this.clearCurrentRoutesParams()}),this.gto.changeScreenTitle$.next({display:"none"}),this.common.loadLkps(this.lstLkpKeys,this.lstLkps,this.handleLkpsLoaded.bind(this)),this.resetCurrentInvoice(),this.subscribeToEvents(),this.common.translateList(this.lstWords),this.fillLayout()}fillLayout(){var e=this;return(0,_.Z)(function*(){e.currentLayout=yield e.gto.getStyle()})()}subscribeToEvents(){this.closePosSelectItemDetails=this.gto.closePosSelectItemDetails$.subscribe(e=>this.handleCloseSelectItem(e)),this.closePosPaymentScreen=this.gto.closePosPaymentScreen$.subscribe(e=>this.handleClosePosPayment(e)),this.closePosOrdersList=this.gto.closePosOrdersList$.subscribe(e=>this.handleClosePosOrdersList(e)),this.closePosMoveOrderItems=this.gto.closePosMoveOrderItems$.subscribe(e=>this.handleClosePosMoveOrderItems(e))}ngOnDestroy(){this.closePosSelectItemDetails&&this.closePosSelectItemDetails.unsubscribe(),this.closePosPaymentScreen&&this.closePosPaymentScreen.unsubscribe(),this.closePosOrdersList&&this.closePosOrdersList.unsubscribe(),this.closePosMoveOrderItems&&this.closePosMoveOrderItems.unsubscribe()}handleLkpsLoaded(){this.lstLkps.ItemGroups&&(this.selectCategory(this.lstLkps.ItemGroups[0]),this.common.fixImagesUrls(this.lstLkps.ItemGroups,"str1"),this.gto.refreshStyle())}selectCategory(e){this.selectedCategory=e,this.loadItems(e)}loadItems(e,o){this.managementService.ItemListWithDetails({GroupId:e.value,SubGroupId:o}).subscribe(n=>{this.common.fixImagesUrls(n.lstData,["img"]),n.lstData.forEach(s=>this.common.fixImagesUrls(s.lstVariants,["img"])),n.lstData.forEach(s=>this.common.fixImagesUrls(s.lstItemAddOns,["img"])),this.common.fixItemDefaultUnits(n.lstData,this.common.getCurrentPosSalesPriceListKey()),e.lstItems=[...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData,...n.lstData],this.gto.refreshStyle()})}selectItem(e){this.CheckItemTypeToAdd(e)}CheckItemTypeToAdd(e){this.model.lstItems||(this.model.lstItems=[]),e.lstVariants&&0!=e.lstVariants.length?this.gto.openPosSelectItemDetails$.next(e):(this.DirectAddItemToCart(e),this.itemsListChanged(),this.notifyNewItemAddedToCart())}DirectAddItemToCart(e){let o=this.mapItemToCart(e),n=this.checkIfItemDeclaredBefore(o);n?n.quantity+=1:this.model.lstItems.push(o)}getItemKey(e){return`${e.itemId}_${e.variantId??""}_${e.sentToKit??"F"}_${e.lstAddOns?e.lstAddOns.sort((o,n)=>o.addOnId-n.addOnId).map(o=>`${o.addOnId}.${o.qty}`).join(","):""}`}checkIfItemDeclaredBefore(e){return this.model.lstItems.find(n=>n.key==e.key)}mapItemToCart(e,o=1){let n={itemId:e.id,price:e.price,unitId:e.unitId,itemUnitId:e.itemUnitId,quantity:o,groupId:e.groupId};return n.name=e.name?e.name:"en"==this.common.currLang?e.nameEn:e.nameAr,e.variantId&&(n.variantId=e.variantId,n.variantName=e.variantName,n.variantPrice=e.variantPrice),e.lstAddOns&&(n.lstAddOns=e.lstAddOns),n.key=this.getItemKey(n),n}handleCloseSelectItem(e){e&&(this.DirectAddItemToCart(e),this.itemsListChanged(),this.notifyNewItemAddedToCart())}notifyNewItemAddedToCart(){this.gto.newItemAddedToCart$.next(1)}itemsListChanged(e=this.model){this.invoiceHelperService.refreshItemPrices(e),this.refreshInvoiceTotalQty(this.model)}refreshInvoiceTotalQty(e){e&&e.lstItems&&(e.totQty=this.common.sum(e.lstItems,"quantity"))}addItemsHashKey(e){e&&e.lstItems&&e.lstItems.forEach(o=>{o.key||(o.key=this.getItemKey(o))})}PendingBtn(){this.MakeOrderPending(this.model,{...this.generalPendingOrderCallbacks,onPost:this.PreSubmitOrderPrintPending.bind(this),success:this.AfterSubmitOrderPrintPending.bind(this)})}prepareObjToServer(e){let o=JSON.parse(JSON.stringify(e));return o.ShiftId||(o.ShiftId=this.shiftStateManagement.CurrentShiftId),o.lstDeletedItems&&(o.lstItems||(o.lstItems=[]),o.lstDeletedItems.forEach(n=>delete n.id),o.lstItems.push(...o.lstDeletedItems)),o}MakeOrderPending(e=this.model,o={}){if(this.isValidInvoice(e)){o.onPost&&o.onPost(e);let n=this.prepareObjToServer(e);this.managementService.AddInvoice(n).subscribe(s=>{s.status&&(e.id=s.entityId,o.success&&o.success(e))})}else o.error&&o.error(e)}getInvoiceDetails(e,o={},n="model"){let s=this;this.managementService.InvoiceDetails(e).subscribe(r=>{r?(r.lstItems.forEach(p=>p._sentToKit=p.sentToKit),s[n]=r):this.resetCurrentInvoice(),o.onFinish&&o.onFinish(),this.addItemsHashKey(s[n]),this.refreshInvoiceTotalQty(s[n])})}printInvoice(e,o="Cash"){if(console.log("Print inv",o),o.indexOf("Kit")>-1){this.invoiceHelperService.lstItemGroupsLkp=this.lstLkps.ItemGroups;let n=[];e.lstItems&&n.push(...e.lstItems),e.lstDeletedItems&&n.push(...e.lstDeletedItems),this.invoiceHelperService.printInvoicePartsToKitchens({...e,lstItems:n})}o.indexOf("Cash")>-1&&this.invoiceHelperService.printInvoice(e)}toTables(){this.MakeOrderPending(this.model,{...this.generalPendingOrderCallbacks,error:"",onPost:this.PreSubmitOrderPrintPending.bind(this),success:this.AfterSubmitOrderPrintPending.bind(this)}),this.common.navigateTo("../floors")}clearCurrentRoutesParams(){this.routeTableId="",this.routeTblName="",this.routeInvoiceId="",this.router.navigate([],{queryParams:{}})}resetCurrentInvoice(){let e=this.common.getCurrentUserInfo();this.model={invoiceStatus:1,invoicePosType:0,invoiceCategoryId:e.posDetails.invoiceCategoryId,accountId:e.posDetails.posSalesAccountId,invoiceType:e.posDetails.invoiceType,accountName:e.posDetails.mainAccName,paymentType:0,lstItems:[]},this.routeTableId&&(this.model.invoicePosType=2,this.model.posTableId=this.routeTableId,this.model.posTableName=this.routeTblName)}isValidInvoice(e){return!!(e&&e.lstItems&&e.lstItems.length>0)}handleClosePosPayment(e){console.log("handleClosePosPayment");const o={onPost:this.PreSubmitOrderPrintPay.bind(this),success:this.AfterSubmitOrderPrintPay.bind(this)};this.invoiceHelperService.MakeOrderPayment(e,o)}PaymentBtn(){this.isValidInvoice(this.model)?(this.MakeOrderPending(this.model),this.PaymentScreen(this.model)):this.common.error(this.lstWords.NotValidOrder)}PaymentScreen(e){this.gto.openPosPaymentScreen$.next({orderDetails:e})}QuickAutoPay(){this.isValidInvoice(this.model)?(this.model.invoiceStatus=4,this.model.paid=this.model.finalTotal,this.model.remaining=0,this.MakeOrderPending(this.model,{...this.generalPendingOrderCallbacks,onPost:this.PreSubmitOrderPrintPay.bind(this),success:this.AfterSubmitOrderPrintPay.bind(this)})):this.common.error(this.lstWords.NotValidOrder)}handleClosePosOrdersList(e){"Pick"==e.action&&(this.MakeOrderPending(this.model,{...this.generalPendingOrderCallbacks,error:null,onPost:this.PreSubmitOrderPrintPending.bind(this),success:this.AfterSubmitOrderPrintPending.bind(this)}),this.getInvoiceDetails({id:e.inv.id}))}showOrdersList(){this.gto.openPosOrdersList$.next({apiFilters:{invoiceStatus:1},buttons:{Pick:1}})}openSplitInvoice(e=this.model){if(this.isValidInvoice(e)){this.MakeOrderPending(this.model);let o=JSON.parse(JSON.stringify(e)),n={lstItems:[]};this.common.CopyValues(o,n,["discPer","discAmount","serPer","serAmount","accountId","posTableId","invoicePosType","invoiceCategoryId"]),this.gto.openPosMoveOrderItems$.next({fromOrder:o,toOrder:n,buttons:{PAY:!0}})}else this.common.error(this.lstWords.NotValidOrder)}handleClosePosMoveOrderItems(e){"PAY"==e.action&&(this.MakeOrderPending(e.fromOrder),e.toOrder=this.invoiceHelperService.clearInvoiceItemsPks(e.toOrder),this.MakeOrderPending(e.toOrder),this.PaymentScreen(e.toOrder))}openPosSetup(){this.gto.openPosStyleSetup$.next(1)}printTicket(){this.model.invoiceStatus=3,this.MakeOrderPending(this.model,{...this.generalPendingOrderCallbacks,onPost:this.PreSubmitOrderPrintPay.bind(this),success:this.AfterSubmitOrderPrintPay.bind(this)})}LOG(){}MarkItemsAsSentToKit(e){e.lstItems.forEach(o=>o.sentToKit=!0)}PreSubmitOrderPrintPending(e){e.id&&(this.printInvoice(e,"Kit"),e.printedBeforeSubmit=!0),this.MarkItemsAsSentToKit(e),this.generalPendingOrderCallbacks.onPost(e)}AfterSubmitOrderPrintPending(e){e.id&&!e.printedBeforeSubmit&&this.printInvoice(e,"Kit"),this.generalPendingOrderCallbacks.success(e)}PreSubmitOrderPrintPay(e){e.id&&(this.printInvoice(e,"Kit&Cash"),e.printedBeforeSubmit=!0),this.MarkItemsAsSentToKit(e),this.generalPendingOrderCallbacks.onPost(e)}AfterSubmitOrderPrintPay(e){e.id&&!e.printedBeforeSubmit&&this.printInvoice(e,"Kit&Cash"),this.generalPendingOrderCallbacks.success(e)}logout(){this.common.logout()}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(P.L),t.Y36(y.w),t.Y36(m.F0),t.Y36(v.j),t.Y36(I.p),t.Y36(k.i),t.Y36(m.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-posmain-page"]],decls:27,vars:10,consts:[[1,"flex","justify-between","w-full","posBox"],["id","leftBox",1,"px-1","w-4/5"],[3,"ngTemplateOutlet"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/5"],["CategoriesView",""],["QtyView",""],["ItemsView",""],["ItemsWidgetView1",""],["ItemsWidgetView2",""],["CartView",""],["PosButtons",""],["id","categoryWrapper",1,"cat-View-1"],["id","categoryInner"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"],[1,"flex","w-full"],[1,"mg"],[1,"flex-1","txts"],[1,"p1"],[1,"p2"],["class","itemsViewScroll","id","itemsViewScroll",4,"ngIf"],["id","itemsViewScroll",1,"itemsViewScroll"],[1,"p-3","pb-1","font-bold","text-2xl"],[4,"ngIf"],["class","item-View-1",4,"ngIf"],[1,"item-View-1"],[1,"items-grid-setup"],["class","flex flex-col justify-between shadow-[4px_6px_10px_-3px_#bfc9d4] itm itemb",3,"click",4,"ngFor","ngForOf"],[1,"flex","flex-col","justify-between","shadow-[4px_6px_10px_-3px_#bfc9d4]","itm","itemb",3,"click"],[1,"flex"],[1,"txts"],[1,"text-white-dark","p2"],[1,"flex","bx-1"],[1,"price"],[1,"unit"],["class","item-View-2",4,"ngIf"],[1,"item-View-2"],["id","items-grid-setup"],[3,"orderDetails","cartChangeItemQty","calculateInvoiceTotals"],["id","buttonsBox",1,"buttonsBox"],[1,"gap-2","grid","grid-cols-6","grid-rows-2","grid-flow-col"],["type","button","appShiftBlock","",1,"row-span-2","btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","appShiftBlock","",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["hlMenu","",1,"dropdown"],["type","button","hlMenuButton","",1,"inline-flex","w-full","btn","btn-info","dropdown-toggle"],["class","ltr:right-0 bottom-full rtl:left-0 !mt-0 mb-1 whitespace-nowrap",4,"hlMenuItems"],[3,"ShowButtons"],["type","button","appShiftBlock","",1,"btn","btn-dark",3,"click"],["type","button","appShiftBlock","",1,"row-span-2","btn","btn-success",3,"click"],[1,"ltr:right-0","bottom-full","rtl:left-0","!mt-0","mb-1","whitespace-nowrap"],["href","javascript:;",3,"click",4,"hlMenuItem"],["href","javascript:;",3,"click"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1),t.GkF(2,2),t.TgZ(3,"div"),t.GkF(4,3)(5,2),t.qZA()(),t.TgZ(6,"div",4),t.GkF(7,3),t.qZA()(),t.YNc(8,pt,3,1,"ng-template",null,5,t.W1O),t.YNc(10,gt,0,0,"ng-template",null,6,t.W1O),t.YNc(12,Ct,1,1,"ng-template",null,7,t.W1O),t.YNc(14,yt,1,1,"ng-template",null,8,t.W1O),t.YNc(16,Tt,1,1,"ng-template",null,9,t.W1O),t.YNc(18,St,1,3,"ng-template",null,10,t.W1O),t.YNc(20,Mt,32,28,"ng-template",null,11,t.W1O),t._UZ(22,"app-pay-order-popup")(23,"app-select-item-variant-add-on")(24,"app-pos-orders-list")(25,"app-move-order-items")(26,"app-pos-page-layout")),2&o){const s=t.MAs(9),r=t.MAs(13),p=t.MAs(19),S=t.MAs(21);t.xp6(2),t.Q6J("ngTemplateOutlet",s),t.xp6(2),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(6,C,n.selectedCategory)),t.xp6(1),t.Q6J("ngTemplateOutlet",S),t.xp6(2),t.Q6J("ngTemplateOutlet",p)("ngTemplateOutletContext",t.VKq(8,C,n.selectedCategory))}},dependencies:[c.sg,c.O5,c.tP,q.e,g.B$,g.zk,g._f,g.e6,N.$,J.b,K._,H.Z,M,X.V,A,f.X$],styles:[".posBox[_ngcontent-%COMP%]{background:#f1f1f1;height:100vh}.cat-View-1[_ngcontent-%COMP%]{.itm {background-color: white; display: flex; justify-content: center; align-items: center; .mg {height: 58px; min-width: 80px} .mg {border-radius: .25rem;} .mg {background-size: cover;} .mg {background-position: center;} .p1 {font-size: 1.25rem; line-height: 1.75rem;} .p1 {font-weight: 600;} .p2 {font-size: .875rem; line-height: 1.25rem;} .p2 {font-weight: 600;} .txts {padding-left: .5rem; padding-right: .5rem;}} .itm {cursor: pointer;} .itm {border-radius: .25rem;} .itm {padding: .75rem;} .itm.selected {background-color: #3772f0; color: white;} .no-image {.mg {display: none;}} padding: .5rem}.item-View-1[_ngcontent-%COMP%]{.itm {background-color: white; .no-image .mg {display: none;} .mg {min-width: 85px; height: 75px} .mg {border-radius: .25rem;} .mg {background-size: cover;} .mg {background-position: center;} .p1 {font-size: 1.125rem; line-height: 1.75rem;} .p1 {font-weight: 700;} .p2 {font-size: .75rem; line-height: 1rem;} .txts {flex-grow: 3} .txts {padding-left: .5rem; padding-right: .5rem;} .price {font-size: 1.5rem; line-height: 2rem;} .price {font-weight: 800;} .bx-1 {align-items: center;} .bx-1 {justify-content: space-between;}} .itm {cursor: pointer;} .itm {border-radius: .25rem;} .itm {padding: .75rem;} .itm.selected {background-color: #3772f0; color: white;} .no-image {.mg {display: none;}} padding: .5rem}.item-View-2[_ngcontent-%COMP%]{.itm {background-color: white; .no-image .mg {display: none;} .mg {min-width: 100%; height: 150px} .mg {border-radius: .25rem;} .mg {background-size: cover;} .mg {background-position: center;} .p1 {font-size: 1.125rem; line-height: 1.75rem;} .p1 {font-weight: 700;} .p2 {font-size: .75rem; line-height: 1rem;} .price {font-size: 1.25rem; line-height: 1.75rem;} .price {font-weight: 700;} .bx-1 {align-items: center;} .bx-1 {justify-content: space-between;}} .itm {cursor: pointer;} .itm {border-radius: .25rem;} .itm {padding: .75rem;} .itm.selected {background-color: #3772f0; color: white;} .no-image {.mg {display: none;}} padding: .5rem}.item-View-1[_ngcontent-%COMP%], .item-View-2[_ngcontent-%COMP%]{.unit {font-size: 15px; font-weight: normal;}}.h-100vh[_ngcontent-%COMP%]{height:99vh;overflow-y:auto}.h-72vh[_ngcontent-%COMP%]{height:72vh}.h-82vh[_ngcontent-%COMP%]{height:72.5vh}.itemsViewScroll[_ngcontent-%COMP%]{overflow-y:auto}.buttonsBox[_ngcontent-%COMP%]{background:#f1f1f1;width:100%;display:flex;justify-content:center;align-items:center;.button {font-size: 18px;} padding-top: .25rem;padding-bottom:.25rem;padding-left:.5rem;padding-right:.5rem}"],data:{animation:[(0,u.X$)("toggleAnimation",[(0,u.eR)(":enter",[(0,u.oB)({opacity:0,transform:"scale(0.95)"}),(0,u.jt)("100ms ease-out",(0,u.oB)({opacity:1,transform:"scale(1)"}))]),(0,u.eR)(":leave",[(0,u.jt)("75ms",(0,u.oB)({opacity:0,transform:"scale(0.95)"}))])])]}})}return i})()}];let At=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(Zt),m.Bz]})}return i})();var wt=l(332),T=l(9116),Lt=l(8904),kt=l(3826),qt=l(7679),Nt=l(9126);const Jt=[{path:"",component:M}];let Kt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(Jt),m.Bz]})}return i})(),Ht=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[c.ez,Kt,T.Q,d.u5,d.UX,f.aw,h.y]})}return i})();var L=l(9798);const Ut=[{path:"",component:A}];let Gt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(Ut),m.Bz]})}return i})();var Ft=l(4868);let Dt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[c.ez,Gt,T.Q,d.u5,Ft.tA,d.UX,L.m,h.y,Z.A0]})}return i})(),Qt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({providers:[y.w],imports:[c.ez,At,wt.B,d.u5,g.$9,T.Q,Lt.l,kt.n,qt.b,Nt.n,Ht,L.m,Dt]})}return i})()}}]);