{"version":3,"file":"headlessui-angular.mjs","sources":["../../../projects/headlessui-angular/src/lib/util.ts","../../../projects/headlessui-angular/src/lib/menu/menu.ts","../../../projects/headlessui-angular/src/public-api.ts","../../../projects/headlessui-angular/src/headlessui-angular.ts"],"sourcesContent":["let id = 1;\nexport const generateId = () => id++;\n/* for testing only */\nexport const resetIdCounter = () => (id = 1);\n","import {\n  ChangeDetectorRef,\n  Directive,\n  ElementRef,\n  EmbeddedViewRef,\n  Input,\n  NgModule,\n  OnInit,\n  Renderer2,\n  TemplateRef,\n  ViewContainerRef,\n} from '@angular/core';\nimport { generateId } from '../util';\n\n/// MENU - Spec: https://www.w3.org/TR/wai-aria-practices-1.2/#menubutton\n\n@Directive({\n  selector: '[hlMenu]',\n  exportAs: 'hlMenu',\n})\nexport class MenuDirective {\n  @Input()\n  static = false;\n\n  expanded = false;\n  windowClickUnlisten!: () => void;\n\n  menuButton!: MenuButtonDirective;\n  menuItemsPanel!: MenuItemsPanelDirective;\n  menuItems: MenuItemDirective[] = [];\n  activeItem: MenuItemDirective | null = null;\n  searchQuery = '';\n  searchDebounce: ReturnType<typeof setTimeout> | null = null;\n\n  constructor(\n    private renderer: Renderer2,\n    private changeDetection: ChangeDetectorRef\n  ) {}\n\n  toggle(focusAfterExpand: FocusType | null = null, focusButtonOnClose = true) {\n    if (this.expanded) {\n      // close items panel\n      this.expanded = false;\n      this.menuItemsPanel.collapse();\n      this.menuButton.element.removeAttribute('aria-controls');\n      this.menuButton.element.removeAttribute('expanded');\n      this.menuItems = [];\n      this.activeItem = null;\n      this.windowClickUnlisten();\n      if (focusButtonOnClose) {\n        this.menuButton.focus();\n      }\n      this.changeDetection.markForCheck();\n    } else {\n      // open items panel\n      this.expanded = true;\n      this.changeDetection.markForCheck();\n\n      setTimeout(() => {\n        this.menuItemsPanel.expand();\n        this.menuItemsPanel.focus();\n        if (this.menuItemsPanel.element != null) {\n          this.menuButton.element.setAttribute(\n            'aria-controls',\n            this.menuItemsPanel.element.id\n          );\n        }\n        this.menuButton.element.setAttribute('expanded', 'true');\n        this.windowClickUnlisten = this.initListeners();\n        if (focusAfterExpand) {\n          setTimeout(() => this.focusItem(focusAfterExpand));\n        }\n      });\n    }\n  }\n\n  focusItem(focusType: FocusType) {\n    const activeItem = this.calculateFocusedItem(focusType);\n    if (activeItem === this.activeItem) {\n      return;\n    }\n    this.activeItem = activeItem;\n    this.menuItems.forEach((item) => {\n      if (this.activeItem) {\n        this.menuItemsPanel.element?.setAttribute(\n          'aria-activedescendant',\n          this.activeItem.element.id\n        );\n      } else {\n        this.menuItemsPanel.element?.removeAttribute('aria-activedescendant');\n      }\n      item.setActive(item === this.activeItem);\n    });\n  }\n\n  clickActive() {\n    this.activeItem?.element.click();\n  }\n\n  search(value: string) {\n    if (this.searchDebounce) {\n      clearTimeout(this.searchDebounce);\n    }\n    this.searchDebounce = setTimeout(() => (this.searchQuery = ''), 350);\n\n    this.searchQuery += value.toLocaleLowerCase();\n    const matchingItem = this.menuItems.find((item) => {\n      const itemText = item.element.textContent?.trim().toLocaleLowerCase();\n      return itemText?.startsWith(this.searchQuery) && !item.hlMenuItemDisabled;\n    });\n\n    if (matchingItem === undefined || matchingItem === this.activeItem) {\n      return;\n    }\n\n    this.focusItem({ kind: 'FocusSpecific', item: matchingItem });\n  }\n\n  private calculateFocusedItem(focusType: FocusType): MenuItemDirective | null {\n    const enabledItems = this.menuItems.filter(\n      (item) => !item.hlMenuItemDisabled\n    );\n\n    switch (focusType.kind) {\n      case 'FocusSpecific':\n        return focusType.item;\n\n      case 'FocusNothing':\n        return null;\n\n      case 'FocusFirst':\n        return enabledItems[0];\n\n      case 'FocusLast':\n        return enabledItems[enabledItems.length - 1];\n\n      case 'FocusNext':\n        if (this.activeItem === null) {\n          return enabledItems[0];\n        } else {\n          const nextIndex = Math.min(\n            enabledItems.indexOf(this.activeItem) + 1,\n            enabledItems.length - 1\n          );\n          return enabledItems[nextIndex];\n        }\n\n      case 'FocusPrevious':\n        if (this.activeItem === null) {\n          return enabledItems[enabledItems.length - 1];\n        } else {\n          const previousIndex = Math.max(\n            enabledItems.indexOf(this.activeItem) - 1,\n            0\n          );\n          return enabledItems[previousIndex];\n        }\n    }\n  }\n\n  private initListeners(): () => void {\n    return this.renderer.listen(window, 'click', (event: MouseEvent) => {\n      const target = event.target as HTMLElement;\n      const active = document.activeElement;\n\n      if (\n        this.menuButton.element.contains(target) ||\n        this.menuItemsPanel?.element?.contains(target)\n      ) {\n        return;\n      }\n\n      const clickedTargetIsFocusable =\n        active !== document.body && active?.contains(target);\n\n      // do not focus button if the clicked element is itself focusable\n      this.toggle(null, !clickedTargetIsFocusable);\n    });\n  }\n}\n\n// MENU ITEM BUTTON\n\n@Directive({\n  selector: '[hlMenuButton]',\n})\nexport class MenuButtonDirective implements OnInit {\n  element!: HTMLElement;\n\n  constructor(\n    elementRef: ElementRef,\n    private menu: MenuDirective,\n    private renderer: Renderer2\n  ) {\n    this.element = elementRef.nativeElement;\n    menu.menuButton = this;\n  }\n\n  ngOnInit(): void {\n    this.initAttributes(this.element);\n\n    this.renderer.listen(this.element, 'click', () => {\n      this.menu.toggle();\n    });\n\n    this.renderer.listen(this.element, 'keydown', (event: KeyboardEvent) => {\n      switch (event.key) {\n        case ' ': // Space\n        case 'Enter':\n        case 'ArrowDown':\n          event.preventDefault();\n          this.menu.toggle({ kind: 'FocusFirst' });\n          break;\n\n        case 'ArrowUp':\n          event.preventDefault();\n          this.menu.toggle({ kind: 'FocusLast' });\n          break;\n      }\n    });\n  }\n\n  focus() {\n    setTimeout(() => this.element?.focus());\n  }\n\n  private initAttributes(element: HTMLElement) {\n    element.id = `headlessui-menu-button-${generateId()}`;\n    element.setAttribute('type', 'button');\n    element.setAttribute('aria-haspopup', 'true');\n  }\n}\n\n/// MENU ITEMS PANEL\n\n@Directive({\n  selector: '[hlMenuItems]',\n})\nexport class MenuItemsPanelDirective implements OnInit {\n  element: HTMLElement | null = null;\n\n  constructor(\n    private templateRef: TemplateRef<any>,\n    private viewContainerRef: ViewContainerRef,\n    private menu: MenuDirective,\n    private renderer: Renderer2\n  ) {\n    this.menu.menuItemsPanel = this;\n  }\n\n  ngOnInit(): void {\n    if (this.menu.static) {\n      this.expandInternal();\n    }\n  }\n\n  expand() {\n    if (!this.menu.static) {\n      this.expandInternal();\n    }\n  }\n\n  collapse() {\n    if (!this.menu.static) {\n      this.viewContainerRef.clear();\n      this.element = null;\n    }\n  }\n\n  focus() {\n    this.element?.focus({ preventScroll: true });\n  }\n\n  private expandInternal() {\n    const view = this.viewContainerRef.createEmbeddedView(this.templateRef);\n    const element = view.rootNodes[0];\n    this.initAttributes(element);\n    this.initListeners(element);\n    this.element = element;\n    view.markForCheck();\n  }\n\n  private initAttributes(element: HTMLElement) {\n    element.tabIndex = -1;\n    element.id = `headlessui-menu-items-${generateId()}`;\n    element.setAttribute('role', 'menu');\n    element.setAttribute('aria-labelledby', this.menu.menuButton.element.id);\n  }\n\n  private initListeners(element: HTMLElement) {\n    this.renderer.listen(element, 'keydown', (event: KeyboardEvent) => {\n      switch (event.key) {\n        case ' ': // Space\n          if (this.menu.searchQuery !== '') {\n            event.preventDefault();\n            this.menu.search(event.key);\n          } else {\n            event.preventDefault();\n            this.menu.clickActive();\n          }\n          break;\n        case 'Enter':\n          event.preventDefault();\n          this.menu.clickActive();\n          break;\n\n        case 'ArrowDown':\n          event.preventDefault();\n          this.menu.focusItem({ kind: 'FocusNext' });\n          break;\n\n        case 'ArrowUp':\n          event.preventDefault();\n          this.menu.focusItem({ kind: 'FocusPrevious' });\n          break;\n\n        case 'Home':\n        case 'PageUp':\n          event.preventDefault();\n          this.menu.focusItem({ kind: 'FocusFirst' });\n          break;\n\n        case 'End':\n        case 'PageDown':\n          event.preventDefault();\n          this.menu.focusItem({ kind: 'FocusLast' });\n          break;\n\n        case 'Escape':\n          event.preventDefault();\n          this.menu.toggle();\n          break;\n\n        case 'Tab':\n          event.preventDefault();\n          break;\n\n        default:\n          if (event.key.length === 1) {\n            this.menu.search(event.key);\n          }\n      }\n    });\n  }\n}\n\n// MENU ITEM\n\n@Directive({\n  selector: '[hlMenuItem]',\n})\nexport class MenuItemDirective implements OnInit {\n  @Input()\n  hlMenuItemDisabled = false;\n\n  element!: HTMLElement;\n\n  private view!: EmbeddedViewRef<any>;\n  private context = { active: false };\n\n  constructor(\n    private templateRef: TemplateRef<any>,\n    private viewContainerRef: ViewContainerRef,\n    private menu: MenuDirective,\n    private renderer: Renderer2\n  ) {\n    this.menu.menuItems.push(this);\n  }\n\n  ngOnInit(): void {\n    this.view = this.viewContainerRef.createEmbeddedView(this.templateRef, {\n      $implicit: this.context,\n    });\n    this.element = this.view.rootNodes[0];\n    this.initAttributes(this.element);\n    this.initListeners(this.element);\n  }\n\n  setActive(active: boolean) {\n    this.context.active = active;\n    this.view.markForCheck();\n  }\n\n  private initAttributes(element: HTMLElement) {\n    element.id = `headlessui-menu-item-${generateId()}`;\n    element.tabIndex = -1;\n    element.setAttribute('role', 'menuitem');\n    if (this.hlMenuItemDisabled) {\n      this.element.setAttribute('aria-disabled', 'true');\n    } else {\n      this.element.removeAttribute('aria-disabled');\n    }\n  }\n\n  private initListeners(element: HTMLElement) {\n    this.renderer.listen(element, 'pointermove', () =>\n      this.menu.focusItem({ kind: 'FocusSpecific', item: this })\n    );\n\n    this.renderer.listen(element, 'pointerleave', () =>\n      this.menu.focusItem({ kind: 'FocusNothing' })\n    );\n\n    this.renderer.listen(element, 'click', (event) => {\n      if (this.hlMenuItemDisabled) {\n        event.preventDefault();\n        return;\n      }\n      this.menu.toggle();\n    });\n  }\n}\n\ntype FocusFirst = { kind: 'FocusFirst' };\ntype FocusLast = { kind: 'FocusLast' };\ntype FocusPrevious = { kind: 'FocusPrevious' };\ntype FocusNext = { kind: 'FocusNext' };\ntype FocusNothing = { kind: 'FocusNothing' };\ntype FocusSpecific = { kind: 'FocusSpecific'; item: MenuItemDirective };\n\ntype FocusType =\n  | FocusFirst\n  | FocusLast\n  | FocusPrevious\n  | FocusNext\n  | FocusNothing\n  | FocusSpecific;\n\n@NgModule({\n  imports: [],\n  exports: [\n    MenuDirective,\n    MenuButtonDirective,\n    MenuItemsPanelDirective,\n    MenuItemDirective,\n  ],\n  declarations: [\n    MenuDirective,\n    MenuButtonDirective,\n    MenuItemsPanelDirective,\n    MenuItemDirective,\n  ],\n  providers: [],\n})\nexport class MenuModule {}\n","// eslint-disable-next-line @typescript-eslint/semi\nexport * from './lib/menu/menu';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}